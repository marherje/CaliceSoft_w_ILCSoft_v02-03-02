\section{marlin\-:\-:Run\-Info\-Processor Class Reference}
\label{classmarlin_1_1RunInfoProcessor}\index{marlin\-::\-Run\-Info\-Processor@{marlin\-::\-Run\-Info\-Processor}}


Preprocessor which is supposed to run at the !very! beginning of the processor chain.  




{\ttfamily \#include $<$Run\-Info\-Processor.\-hh$>$}

Inheritance diagram for marlin\-:\-:Run\-Info\-Processor\-:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classmarlin_1_1RunInfoProcessor}
\end{center}
\end{figure}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
class {\bf L\-C\-Run\-Modifier}
\begin{DoxyCompactList}\small\item\em Helper class to for the modification of the Run Header. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual Processor $\ast$ {\bfseries new\-Processor} ()\label{classmarlin_1_1RunInfoProcessor_ab8aa029e7fee27866206787f322b3616}

\item 
virtual void {\bf init} ()
\begin{DoxyCompactList}\small\item\em Called at the begin of the job before anything is read. \end{DoxyCompactList}\item 
virtual void {\bf process\-Run\-Header} (L\-C\-Run\-Header $\ast$run)\label{classmarlin_1_1RunInfoProcessor_a037d6642c5effd5ea57ef2d3dec2ce47}

\begin{DoxyCompactList}\small\item\em Called for every run. \end{DoxyCompactList}\item 
virtual void {\bf process\-Event} (L\-C\-Event $\ast$evt)\label{classmarlin_1_1RunInfoProcessor_a44b26122c6d673c48d5c2e0dfc5a10fd}

\begin{DoxyCompactList}\small\item\em Called for every event -\/ the working horse. \end{DoxyCompactList}\item 
virtual const std\-::string \& {\bf name} () const \label{classmarlin_1_1RunInfoProcessor_a4e0b06142a6fe83a607f8fbbfc5f3a07}

\begin{DoxyCompactList}\small\item\em Needed for modify\-Event. \end{DoxyCompactList}\item 
virtual void {\bfseries modify\-Event} (L\-C\-Event $\ast$evt)\label{classmarlin_1_1RunInfoProcessor_a87835b19afc2566d1edf358c49060243}

\item 
virtual void {\bfseries check} (L\-C\-Event $\ast$evt)\label{classmarlin_1_1RunInfoProcessor_a13101be4c139383d19a2578cac39fc21}

\item 
virtual void {\bf end} ()\label{classmarlin_1_1RunInfoProcessor_a8c82fcf3504ddc1d1cd83bd3df48b8a1}

\begin{DoxyCompactList}\small\item\em Called after data processing for clean up. \end{DoxyCompactList}\item 
void {\bf print\-Run\-Parameters} (const L\-C\-Run\-Header $\ast$run)\label{classmarlin_1_1RunInfoProcessor_ae0df13a558cff819a125d7da430d3ca8}

\begin{DoxyCompactList}\small\item\em Method to write the histograms in a R\-O\-O\-T file. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void {\bf set\-Vers\-String} (std\-::string)\label{classmarlin_1_1RunInfoProcessor_ac7333b2dd94c0dfaf019efda7d51783c}

\begin{DoxyCompactList}\small\item\em The function which sets the version string. \end{DoxyCompactList}\item 
unsigned int {\bf handle\-Beam\-Parameters} (L\-C\-C\-D\-Time\-Stamp)
\begin{DoxyCompactList}\small\item\em Handling of beam parameters to extract energy. \end{DoxyCompactList}\item 
float {\bf time\-Cor} ()
\begin{DoxyCompactList}\small\item\em A helper function which determines corrections to be applied when check for r/o time of (cern) database of cern beam parameters. \end{DoxyCompactList}\item 
unsigned int {\bf get\-Beam\-Energy} (const L\-C\-C\-D\-Time\-Stamp)\label{classmarlin_1_1RunInfoProcessor_af25973c2f75e0cc7d1a2e963ae6f1ae0}

\begin{DoxyCompactList}\small\item\em Method to get the beam energy from the database for a given time stamp (default) \end{DoxyCompactList}\item 
unsigned int {\bf get\-Beam\-Energy\-User} (const L\-C\-C\-D\-Time\-Stamp)\label{classmarlin_1_1RunInfoProcessor_a2a9f3d4420e6d5413b52aa4a9f909ab2}

\begin{DoxyCompactList}\small\item\em Method to get the beam energy from the database for a given time stamp (user defined settings) \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
std\-::string {\bf \-\_\-db\-Init}\label{classmarlin_1_1RunInfoProcessor_a65053a1bdf8789ad7285a32739a69807}

\begin{DoxyCompactList}\small\item\em dbinit string, note that in this Processor we cannot make use of the Conditions\-Data\-Processor Mechanism as it may run also on M\-C where the event time has to be set by this processor \end{DoxyCompactList}\item 
std\-::string {\bf \-\_\-folder\-Run\-Time}\label{classmarlin_1_1RunInfoProcessor_aeb0c70371d7b4e0cd37581188894103e}

\begin{DoxyCompactList}\small\item\em The variable holding the folder name from which we fetch the runinfo. \end{DoxyCompactList}\item 
std\-::string {\bf \-\_\-folder\-Beam\-Parameter}\label{classmarlin_1_1RunInfoProcessor_adbdb31a2fc1c90aa15700d0906a15b15}

\begin{DoxyCompactList}\small\item\em The folder which holds the information on the beam parameter. \end{DoxyCompactList}\item 
float {\bf \-\_\-current\-Tolerance}\label{classmarlin_1_1RunInfoProcessor_aab826ec0a4e9dde1f2b2d4e9a079ee22}

\begin{DoxyCompactList}\small\item\em Tolerance in \% allowed until current reading at run begin and run end is considered to be inconsinstent. \end{DoxyCompactList}\item 
float {\bf \-\_\-time\-Tolerance}\label{classmarlin_1_1RunInfoProcessor_abdd63cb1e6b5a847089182c30929ccb8}

\begin{DoxyCompactList}\small\item\em Tolerance in s allowed until reading of beam parameters is considered to be outdated. \end{DoxyCompactList}\item 
std\-::string {\bf \-\_\-folder\-Beam\-Parameter\-Exception}
\begin{DoxyCompactList}\small\item\em The variable which holds the folder name for the Beam\-Parameter\-Exception, i.\-e. \end{DoxyCompactList}\item 
std\-::string {\bf \-\_\-folder\-Location}\label{classmarlin_1_1RunInfoProcessor_a1570d9cda3d532a23820e09b9da4210d}

\begin{DoxyCompactList}\small\item\em The variable which holds the name of the folder to look up the run location. \end{DoxyCompactList}\item 
Run\-Location\-Whizard $\ast$ {\bf \-\_\-runlocationwhizard}\label{classmarlin_1_1RunInfoProcessor_a04731b4d9bb5e6635449ae5e997ea54e}

\begin{DoxyCompactList}\small\item\em The object which holds the information on the run location. \end{DoxyCompactList}\item 
std\-::string {\bf \-\_\-vers\-\_\-string}\label{classmarlin_1_1RunInfoProcessor_a281b035be172c5f29b4406256e6ff660}

\begin{DoxyCompactList}\small\item\em A string which contains the version of the converter and therefore of the db entry. \end{DoxyCompactList}\item 
int {\bf \-\_\-vers\-\_\-length}\label{classmarlin_1_1RunInfoProcessor_ab39f8a9b1988e14a2aeb1879d2ff2eab}

\begin{DoxyCompactList}\small\item\em The length of the version string. \end{DoxyCompactList}\item 
int {\bf \-\_\-run\-Number}\label{classmarlin_1_1RunInfoProcessor_ac765ef550fc7ae185901ab1766afd0f8}

\begin{DoxyCompactList}\small\item\em Obvious variables. \end{DoxyCompactList}\item 
unsigned int {\bfseries \-\_\-beam\-Energy}\label{classmarlin_1_1RunInfoProcessor_a06b6da5104e1817215b1588452dd1dd8}

\item 
int {\bf \-\_\-bending\-Current\-To\-Check}\label{classmarlin_1_1RunInfoProcessor_ad17af4643c8798dab2642df821a87952}

\begin{DoxyCompactList}\small\item\em variables needed to convert current to energy \end{DoxyCompactList}\item 
float {\bfseries \-\_\-current\-To\-Energy}\label{classmarlin_1_1RunInfoProcessor_aec2e8768e37e8807479bec91314b7742}

\item 
float {\bfseries \-\_\-to\-Me\-V}\label{classmarlin_1_1RunInfoProcessor_abbcb57bbb8ed02b4cfd48e81e5792d60}

\item 
int {\bf \-\_\-safety\-Margin}\label{classmarlin_1_1RunInfoProcessor_aaf0d50434eb4366d31750a485d105294}

\begin{DoxyCompactList}\small\item\em Variable which can be used to ensure validity of conditions data in case of M\-C. \end{DoxyCompactList}\item 
int {\bf \-\_\-n\-Run}\label{classmarlin_1_1RunInfoProcessor_a424bd272282d83451deec7a1b3ed65d6}

\begin{DoxyCompactList}\small\item\em Obvious counter variables, needed? \end{DoxyCompactList}\item 
int {\bfseries \-\_\-n\-Evt}\label{classmarlin_1_1RunInfoProcessor_abfcb80607e137bb4cac4a50cb0704a07}

\item 
Run\-Information $\ast$ {\bf \-\_\-run\-Information}\label{classmarlin_1_1RunInfoProcessor_ac4fc44266d6145b8190937b9cce47c8e}

\begin{DoxyCompactList}\small\item\em An object which assembles run information. \end{DoxyCompactList}\item 
U\-T\-I\-L\-::\-L\-C\-Time {\bf \-\_\-event\-Time}\label{classmarlin_1_1RunInfoProcessor_a892d2aa27765a45ee078d8bc713aa88f}

\begin{DoxyCompactList}\small\item\em The event time, created for M\-C, not in use for real data. \end{DoxyCompactList}\item 
bool {\bfseries \-\_\-overwrite\-Run\-Number}\label{classmarlin_1_1RunInfoProcessor_ad5d607ab4fe985cfad5e419a4ea513a8}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
Preprocessor which is supposed to run at the !very! beginning of the processor chain. 

Adding information to the Run and Event\-Header, for data and M\-C. In partcular the beam energy is extracted from the database for a given run and the M\-C events get assigned a timestamp. \begin{DoxyAuthor}{Author}
\-: A.\-M. Magnan Imperial College, modifs R.\-Poeschl L\-A\-L
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
Apr 2007 
\end{DoxyDate}
\begin{DoxyRefDesc}{Todo}
\item[{\bf Todo}]reduce even more the dependency on hardcoded, god given parameters in the code (valid for many processors) \end{DoxyRefDesc}


Definition at line 52 of file Run\-Info\-Processor.\-hh.



\subsection{Member Function Documentation}
\index{marlin\-::\-Run\-Info\-Processor@{marlin\-::\-Run\-Info\-Processor}!handle\-Beam\-Parameters@{handle\-Beam\-Parameters}}
\index{handle\-Beam\-Parameters@{handle\-Beam\-Parameters}!marlin::RunInfoProcessor@{marlin\-::\-Run\-Info\-Processor}}
\subsubsection[{handle\-Beam\-Parameters}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int marlin\-::\-Run\-Info\-Processor\-::handle\-Beam\-Parameters (
\begin{DoxyParamCaption}
\item[{L\-C\-C\-D\-Time\-Stamp}]{starttime}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{classmarlin_1_1RunInfoProcessor_a6f3f736a349f45536e3fc13344536950}


Handling of beam parameters to extract energy. 

\begin{DoxyRefDesc}{Todo}
\item[{\bf Todo}]extend scope of function and maybe turn into dedicated class \end{DoxyRefDesc}


Definition at line 429 of file Run\-Info\-Processor.\-cc.

\index{marlin\-::\-Run\-Info\-Processor@{marlin\-::\-Run\-Info\-Processor}!init@{init}}
\index{init@{init}!marlin::RunInfoProcessor@{marlin\-::\-Run\-Info\-Processor}}
\subsubsection[{init}]{\setlength{\rightskip}{0pt plus 5cm}void marlin\-::\-Run\-Info\-Processor\-::init (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\label{classmarlin_1_1RunInfoProcessor_a51fa73bd662dbffa2d89a04fdd2e92da}


Called at the begin of the job before anything is read. 

Use to initialize the processor, e.\-g. book histograms. 

Definition at line 153 of file Run\-Info\-Processor.\-cc.

\index{marlin\-::\-Run\-Info\-Processor@{marlin\-::\-Run\-Info\-Processor}!time\-Cor@{time\-Cor}}
\index{time\-Cor@{time\-Cor}!marlin::RunInfoProcessor@{marlin\-::\-Run\-Info\-Processor}}
\subsubsection[{time\-Cor}]{\setlength{\rightskip}{0pt plus 5cm}float marlin\-::\-Run\-Info\-Processor\-::time\-Cor (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{classmarlin_1_1RunInfoProcessor_a0070ee9315271f15a55ae80c4bb50acc}


A helper function which determines corrections to be applied when check for r/o time of (cern) database of cern beam parameters. 

\begin{DoxyRefDesc}{Todo}
\item[{\bf Todo}]remove hardcoded times \end{DoxyRefDesc}


Definition at line 570 of file Run\-Info\-Processor.\-cc.



\subsection{Field Documentation}
\index{marlin\-::\-Run\-Info\-Processor@{marlin\-::\-Run\-Info\-Processor}!\-\_\-folder\-Beam\-Parameter\-Exception@{\-\_\-folder\-Beam\-Parameter\-Exception}}
\index{\-\_\-folder\-Beam\-Parameter\-Exception@{\-\_\-folder\-Beam\-Parameter\-Exception}!marlin::RunInfoProcessor@{marlin\-::\-Run\-Info\-Processor}}
\subsubsection[{\-\_\-folder\-Beam\-Parameter\-Exception}]{\setlength{\rightskip}{0pt plus 5cm}std\-::string marlin\-::\-Run\-Info\-Processor\-::\-\_\-folder\-Beam\-Parameter\-Exception\hspace{0.3cm}{\ttfamily [private]}}\label{classmarlin_1_1RunInfoProcessor_a36e4d01591a54d222092bd583b231f56}


The variable which holds the folder name for the Beam\-Parameter\-Exception, i.\-e. 

to be queried in case of pbs. with automatic r/o of beam parameters. 

Definition at line 108 of file Run\-Info\-Processor.\-hh.



The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
Run\-Info\-Processor.\-hh\item 
Run\-Info\-Processor.\-cc\end{DoxyCompactItemize}

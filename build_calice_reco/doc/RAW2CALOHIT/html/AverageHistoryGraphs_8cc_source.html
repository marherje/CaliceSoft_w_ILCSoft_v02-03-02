<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>RAW2CALOHIT: AverageHistoryGraphs.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">RAW2CALOHIT
   &#160;<span id="projectnumber">6.9.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_aa5152576b83acadfecf1e9f3e210c0e.html">calice_reco</a></li><li class="navelem"><a class="el" href="dir_27388c1674127e321e96251325cc79e9.html">raw2calohit</a></li><li class="navelem"><a class="el" href="dir_54cc96177f479d1da214f2f49b97f4f8.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">AverageHistoryGraphs.cc</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifdef HAVE_CONFIG_H</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#  include &lt;config.h&gt;</span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#endif </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//#ifdef HAVE_ROOT</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//#include &lt;TFile.h&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//#include &lt;TGraph.h&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//#include &lt;TGraphErrors.h&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//#endif</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;AverageHistoryGraphs.hh&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;AdcValueAccess.hh&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;stdexcept&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;Average_t.hh&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;CellParameter.hh&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;EVENT/LCParameters.h&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;marlin/ConditionsProcessor.h&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;collection_names.hh&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;MakeGraph.hh&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;histmgr/GraphCollection_t.hh&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;histmgr/HistMgr.hh&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;ErrorBits.hh&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//#include &lt;sstream&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#define PAR_EVENTS_SINCE_LAST_DAQ_STATE_CHANGE &quot;CALDAQ_EventsSinceLastChange&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">namespace </span>CALICE {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  AverageHistoryGraphs a_AverageHistoryGraphs_instance;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *AverageHistoryGraphs::__historyGraphNames[AverageHistoryGraphs::kNHistoryGraphs] ={</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="stringliteral">&quot;ADCHistory&quot;</span>,</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="stringliteral">&quot;NoiseHistory&quot;</span>,</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="stringliteral">&quot;PedestalHistory&quot;</span>,</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="stringliteral">&quot;HitHistory&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  };</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *AverageHistoryGraphs::__graphTypeNames[AverageHistoryGraphs::kNGraphTypes] ={</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="stringliteral">&quot;mean&quot;</span>,</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="stringliteral">&quot;rms&quot;</span>,</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="stringliteral">&quot;min&quot;</span>,</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="stringliteral">&quot;max&quot;</span>,</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="stringliteral">&quot;weight&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  };</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  UInt_t AverageHistoryGraphs::__nSamplesPerChip=18;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  UInt_t AverageHistoryGraphs::__nChips=12;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  AverageHistoryGraphs::AverageHistoryGraphs()</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    :    VRawADCValueProcessor(<span class="stringliteral">&quot;AverageHistoryGraphs&quot;</span>),</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;         _stateChangeHistoryKey(<span class="stringliteral">&quot;StateChangeHistory&quot;</span>),</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;         _confChangeHistoryKey(<span class="stringliteral">&quot;ConfigurationChangeHistory&quot;</span>)</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">//_outputFileName=&quot;history.root&quot;;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">//    registerProcessorParameter( &quot;ResultsFile&quot; , </span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">//                         &quot;The history graphs will be written to the ROOT file of this name.&quot; ,</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">//                         _outputFileName ,</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">//                         _outputFileName);</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">//    _folderName=&quot;&quot;;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">//    registerProcessorParameter( &quot;HistogramDirectoryName&quot; , </span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">//                         &quot;The name of the directory inside the ROOT file to which the history graphs are written to.&quot; ,</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">//                         _folderName ,</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="comment">//                         _folderName);</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    _useTimeStamp=0;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    registerProcessorParameter( <span class="stringliteral">&quot;UseTime&quot;</span> , </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                               <span class="stringliteral">&quot;Use the time stamps instead of the event number.&quot;</span> ,</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                               _useTimeStamp,</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                               _useTimeStamp);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    _cellParameterCollectionName=<span class="stringliteral">&quot;CellParameters&quot;</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    registerProcessorParameter( <span class="stringliteral">&quot;CellParameterCollectionName&quot;</span> , </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                                <span class="stringliteral">&quot;The name of the collection which contains the pedestals, the noise, etc. of all the cells.&quot;</span> ,</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                                _cellParameterCollectionName ,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                _cellParameterCollectionName);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    _monitorConf.clear();</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    registerProcessorParameter( <span class="stringliteral">&quot;MonitorConditionsChanges&quot;</span> , </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                               <span class="stringliteral">&quot;Memorise the event numbers after configuration changes.&quot;</span> ,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                               _monitorConf,</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                               _monitorConf);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    _signalCut=5.;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    registerProcessorParameter( <span class="stringliteral">&quot;SignalCut&quot;</span> , </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                                <span class="stringliteral">&quot;ADC values of cells with a signal-over-noise larger than this value will not be considered.&quot;</span> ,</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                                _signalCut ,</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                                _signalCut);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    registerProcessorParameter( <span class="stringliteral">&quot;SkipCalibrationEvents&quot;</span> , </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                               <span class="stringliteral">&quot;Skip events for which the calibration chip was switched on (Otherwise they are treated as beam events)&quot;</span> ,</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                               _skipCalibrationEventsAlways ,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                               0) ;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    _eventPar.clear();</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    _eventPar.push_back(100);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    _eventPar.push_back(0);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    _eventPar.push_back(200000);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    registerOptionalParameter( <span class="stringliteral">&quot;EventStepsAndRange&quot;</span> , </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                                <span class="stringliteral">&quot;Event step size, first event, and last event. The history is extended in events steps given by the first parameter for events in the range indicated by the second and third parameter&quot;</span>  ,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                _eventPar ,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                               _eventPar);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    _avADCNMax=10;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    registerProcessorParameter( <span class="stringliteral">&quot;AverageOverNEvents&quot;</span> , </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                               <span class="stringliteral">&quot;Calculate per average ADC values per pad using this number of ADC values.&quot;</span> ,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                               _avADCNMax,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                               _avADCNMax);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    registerProcessorParameter( <span class="stringliteral">&quot;HistogramGroupName&quot;</span> , </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                <span class="stringliteral">&quot;The name of the histogram group under which the control histograms will be registered.&quot;</span>  ,</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                                _graphGroupKey.nameStorage() ,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                                type() );</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">for</span> (UInt_t history_i=0; history_i&lt;kNHistoryGraphs; history_i++) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      _avValueHistoryKey.push_back(<a class="code" href="classhistmgr_1_1Key__t.html">histmgr::Key_t</a>(__historyGraphNames[history_i]));</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="classCALICE_1_1AverageHistoryGraphs.html#a3734a824ecbe14585605e459c40b7f67">  121</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classCALICE_1_1AverageHistoryGraphs.html#a3734a824ecbe14585605e459c40b7f67">AverageHistoryGraphs::init</a>() {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    VRawADCValueProcessor::init();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    printParameters();</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    assert(_eventPar.size()==3);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    assert(_eventPar[0]&gt;0);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    assert(_eventPar[1]&lt;=_eventPar[2]);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    _nStateChanges=0;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    _wasState=0;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    _confChanged=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Monitor changes of  &quot;</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">for</span> (StringVec::const_iterator name_iter=_monitorConf.begin();</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;         name_iter!=_monitorConf.end();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;         name_iter++) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      ConditionsChangeDelegator&lt;AverageHistoryGraphs&gt; a(<span class="keyword">this</span>,&amp;AverageHistoryGraphs::configurationChanged);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      _confChanges.push_back( a );</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    UInt_t i=0;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">for</span> (StringVec::const_iterator name_iter=_monitorConf.begin();</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;         name_iter!=_monitorConf.end();</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;         name_iter++, i++) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      marlin::ConditionsProcessor::registerChangeListener( &amp;(_confChanges[i]) ,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                                                           *name_iter );</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      std::cout  &lt;&lt; *name_iter &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    std::cout &lt;&lt; endl;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    _avADCIsValid=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    _avADCn=0;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    EVENT::StringVec empty;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="classhistmgr_1_1HistMgr.html">histmgr::HistMgr</a> *histogramList=histmgr::HistMgr::getInstance();</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    histogramList-&gt;<a class="code" href="classhistmgr_1_1HistMgr.html#a04aa842cbcd765c10fa47afd05a31b6f">createHistogramGroup</a>(_graphGroupKey);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    histogramList-&gt;<a class="code" href="classhistmgr_1_1HistMgr.html#abe2360d4b53c1ac18f193be4e9428e3a">lockGroup</a>(_graphGroupKey);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    histogramList-&gt;<a class="code" href="classhistmgr_1_1HistMgr.html#a89c74c851c7f8cf2b2eef7d358054bd8">createGraphCollection</a>(_graphGroupKey,_stateChangeHistoryKey,1,empty,0,empty,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    histogramList-&gt;<a class="code" href="classhistmgr_1_1HistMgr.html#a89c74c851c7f8cf2b2eef7d358054bd8">createGraphCollection</a>(_graphGroupKey,_confChangeHistoryKey,1,empty,0,empty,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordtype">void</span> AverageHistoryGraphs::resizeArrays() {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">if</span> (!_mapping.isModuleConditionsDataComplete()) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">if</span> (_mapping.getNModules()==0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="classhistmgr_1_1HistMgr.html">histmgr::HistMgr</a> *histogramList=histmgr::HistMgr::getInstance();</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    Bool_t need_to_resize_array=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    assert (_avValueHistoryKey.size()&gt;0 );</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">if</span> (_mapping.getNModules()!=_avADC.size() </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        || !histogramList-&gt;histogramGroupExists(_graphGroupKey) </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        || !histogramList-&gt;histogramGroup(_graphGroupKey).<a class="code" href="classhistmgr_1_1HistMgr_1_1Group__t.html#a6dcb61b2793e12470bfd28e4dfeaafef">histogramCollectionExists</a>(_avValueHistoryKey[0])</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        || !histogramList-&gt;histogramGroup(_graphGroupKey).<a class="code" href="classhistmgr_1_1HistMgr_1_1Group__t.html#aba01ed4567e276b2a71494f6755c520f">histogramCollection</a>(_avValueHistoryKey[0]).<a class="code" href="classhistmgr_1_1HistogramCollection__t.html#a02818178f9b34adc8fc34077f1111ae0">nMajor</a>()==_mapping.getNModules()) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      need_to_resize_array=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordflow">for</span> (UInt_t module_i=0; module_i&lt;_mapping.getNModules(); module_i++) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordflow">if</span> (   _mapping.getNCellsPerModule(module_i) != _avADC[module_i].size()</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            || _mapping.getNCellsPerModule(module_i)/__nSamplesPerChip != histogramList-&gt;histogramGroup(_graphGroupKey).<a class="code" href="classhistmgr_1_1HistMgr_1_1Group__t.html#aba01ed4567e276b2a71494f6755c520f">histogramCollection</a>(_avValueHistoryKey[0]).<a class="code" href="classhistmgr_1_1HistogramCollection__t.html#aba86c24635ec931b9eef136bddaa897c">nMinor</a>(module_i)) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;          need_to_resize_array=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> (!need_to_resize_array) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    histogramList-&gt;<a class="code" href="classhistmgr_1_1HistMgr.html#ac3793935c147dc10f3ef167632794802">writeHistograms</a>(_graphGroupKey, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// writeGraphs();</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    _avADC.clear();</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    _avADC.resize(_mapping.getNModules());</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">for</span> (UInt_t module_i=0; module_i&lt;_mapping.getNModules(); module_i++) {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      _avADC[module_i].resize(_mapping.getNCellsPerModule(module_i));</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    _avADCIsValid=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    _avADCn=0;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">for</span> (UInt_t history_i=0; history_i&lt;kNHistoryGraphs; history_i++) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      _avValues[history_i].clear();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      _avValues[history_i].resize(_mapping.getNModules());</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordflow">for</span> (UInt_t module_i=0; module_i&lt;_mapping.getNModules(); module_i++) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        _avValues[history_i][module_i].resize(_mapping.getNCellsPerModule(module_i)/__nSamplesPerChip);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    EVENT::StringVec types;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">for</span> (UInt_t type_i=0; type_i&lt;kNGraphTypes; type_i++) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      types.push_back(__graphTypeNames[type_i]);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    EVENT::IntVec n_chips;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">for</span> (UInt_t module_i=0; module_i&lt;_mapping.getNModules(); module_i++) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      n_chips.push_back(_mapping.getNCellsPerModule(module_i)/__nSamplesPerChip);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    EVENT::StringVec empty;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">for</span> (std::vector&lt;histmgr::Key_t&gt;::const_iterator history_iter=_avValueHistoryKey.begin();</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;         history_iter!=_avValueHistoryKey.end();</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;         history_iter++) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      EVENT::StringVec module_names;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="keywordflow">for</span> (UInt_t module_i=0; module_i&lt;_mapping.getNModules(); module_i++) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        std::stringstream a_name;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        CellIndex cell_index(_mapping.getGeometricalCellIndex(module_i,0));</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        a_name &lt;&lt; history_iter-&gt;name() &lt;&lt; <span class="stringliteral">&quot;_module_&quot;</span> &lt;&lt; module_i &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; _mapping.getModuleName(module_i) &lt;&lt; <span class="stringliteral">&quot;_layer_&quot;</span> &lt;&lt; cell_index.getLayerIndex();</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        module_names.push_back(a_name.str());</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      histogramList-&gt;<a class="code" href="classhistmgr_1_1HistMgr.html#a89c74c851c7f8cf2b2eef7d358054bd8">createGraphCollection</a>(_graphGroupKey,*history_iter,n_chips,types,0,module_names,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">//    for (UInt_t history_i=0; history_i&lt;kNHistoryGraphs; history_i++) {</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">//      for (UInt_t graph_i=0; graph_i&lt;kNGraphs; graph_i++) {</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">//  _history[history_i][graph_i].clear();</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">//  _history[history_i][graph_i].resize(_mapping.getNModules());</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">//  for (UInt_t module_i=0; module_i&lt;_mapping.getNModules(); module_i++) {</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">//    _history[history_i][graph_i][module_i].resize(_mapping.getNCellsPerModule(module_i)/__nSamplesPerChip);</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">//  }</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">//      }</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">//    }</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">//    for (UInt_t hist_i=0; hist_i&lt;kNHistoryStamps; hist_i++) {</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">//      _historyStamps[hist_i].clear();</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">//    }</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="classCALICE_1_1AverageHistoryGraphs.html#a1b70e2c0f46158aac6fe28edb2ca23cf">  251</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classCALICE_1_1AverageHistoryGraphs.html#a1b70e2c0f46158aac6fe28edb2ca23cf">AverageHistoryGraphs::processEvent</a>( LCEvent * evtP ) {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    CALICE::ErrorBits error(evtP-&gt;getParameters().getIntVal(PAR_ERROR_BITS));</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    UInt_t event_nr=evtP-&gt;getEventNumber();</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    Int_t isState=evtP-&gt;parameters().getIntVal(PAR_RECO_STATE);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    UInt_t events_since_last_slow_conf_record=evtP-&gt;parameters().getIntVal(PAR_EVENTS_SINCE_LAST_DAQ_STATE_CHANGE);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">//FIXME: does not make any sense if runs are chained.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">if</span> (event_nr&gt;=static_cast&lt;UInt_t&gt;(_eventPar[1]) &amp;&amp; event_nr&lt;=static_cast&lt;UInt_t&gt;(_eventPar[2])) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <a class="code" href="classhistmgr_1_1HistMgr.html">histmgr::HistMgr</a> *histogramList=histmgr::HistMgr::getInstance();</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="comment">// FIXME: cannot store nanosecond resolution !</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      Float_t stamp=(_useTimeStamp&gt;0 ? <span class="keyword">static_cast&lt;</span>Float_t<span class="keyword">&gt;</span>(evtP-&gt;getTimeStamp()) : static_cast&lt;Float_t&gt;(event_nr));</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="keywordflow">if</span> (error.corruptEventRecord() || (_skipCalibrationEventsAlways!=0 &amp;&amp; isState==kRecoStateCalibration)) {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        isState=(error.corruptEventRecord() ? -2 : -1 );</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">if</span> (_wasState != isState ) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;          <a class="code" href="classhistmgr_1_1GraphCollection__t.html">histmgr::GraphCollection_t</a> &amp;graph_col=histogramList-&gt;<a class="code" href="classhistmgr_1_1HistMgr.html#a6c5ea89b82f7d9df93423976abdf6470">getGraphCollection</a>(_graphGroupKey,_stateChangeHistoryKey);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;          UInt_t val_i = graph_col.<a class="code" href="classhistmgr_1_1GraphCollection__t.html#ae9c83cf79211ef808f75343c7c3c3c3d">appendXValue</a>(stamp);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;          graph_col.<a class="code" href="classhistmgr_1_1GraphCollection__t.html#a2d86a21418a91537e8cb831673b4e88b">setYValue</a>(0,0,val_i, static_cast&lt;float&gt;(isState));</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;          _nStateChanges++;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;          <span class="comment">//      _historyStamps[kHistoryStateStamp].push_back(stamp);</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          <span class="comment">//      _historyStamps[kHistoryStateValue].push_back( isState );</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        _wasState=isState;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;   </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="keywordflow">if</span> (_wasState==isState &amp;&amp; events_since_last_slow_conf_record==0) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        isState=-5;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keywordflow">if</span> (_wasState != isState ) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        _nStateChanges++;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <a class="code" href="classhistmgr_1_1GraphCollection__t.html">histmgr::GraphCollection_t</a> &amp;graph_col=histogramList-&gt;<a class="code" href="classhistmgr_1_1HistMgr.html#a6c5ea89b82f7d9df93423976abdf6470">getGraphCollection</a>(_graphGroupKey,_stateChangeHistoryKey);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        UInt_t val_i = graph_col.<a class="code" href="classhistmgr_1_1GraphCollection__t.html#ae9c83cf79211ef808f75343c7c3c3c3d">appendXValue</a>(stamp);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        graph_col.<a class="code" href="classhistmgr_1_1GraphCollection__t.html#a2d86a21418a91537e8cb831673b4e88b">setYValue</a>(0,0,val_i, static_cast&lt;float&gt;(isState));</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="comment">//_historyStamps[kHistoryStateStamp].push_back(stamp);</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="comment">//_historyStamps[kHistoryStateValue].push_back(isState);</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        _wasState=isState;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keywordflow">if</span> (_confChanged) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <a class="code" href="classhistmgr_1_1GraphCollection__t.html">histmgr::GraphCollection_t</a> &amp;graph_col=histogramList-&gt;<a class="code" href="classhistmgr_1_1HistMgr.html#a6c5ea89b82f7d9df93423976abdf6470">getGraphCollection</a>(_graphGroupKey,_confChangeHistoryKey);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        UInt_t val_i = graph_col.<a class="code" href="classhistmgr_1_1GraphCollection__t.html#ae9c83cf79211ef808f75343c7c3c3c3d">appendXValue</a>(stamp);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        graph_col.<a class="code" href="classhistmgr_1_1GraphCollection__t.html#a2d86a21418a91537e8cb831673b4e88b">setYValue</a>(0,0,val_i, 0.);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="comment">//      _historyStamps[kHistoryConfStamp].push_back(stamp);</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      LCCollection* cell_parameters=0;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      IntVec module_index_array;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        cell_parameters = evtP-&gt;getCollection( _cellParameterCollectionName ) ;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        cell_parameters-&gt;getParameters().getIntVals(std::string(<span class="stringliteral">&quot;ModuleStartIndex&quot;</span>),module_index_array);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keywordflow">catch</span> (  DataNotAvailableException &amp;err) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        LCCollection* col_adc = evtP-&gt;getCollection( <a class="code" href="classCALICE_1_1VRawADCValueProcessor.html#a9af055c07a4e40284ba7851ee901d7af">_adcColName</a> ) ;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="comment">//TODO: not very efficient to copy the int vector every time. In particular, since it rarly changes.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keywordflow">if</span> (col_adc &amp;&amp; col_adc-&gt;getNumberOfElements()&gt;0) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <a class="code" href="classCALICE_1_1AdcValueAccess.html">AdcValueAccess</a> adc_access(col_adc, &amp;_mapping, 0, 0);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <span class="keywordflow">if</span> (adc_access.hasConnectedBlocks()) {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;              <span class="keywordflow">if</span> (!_avADCIsValid) {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="preprocessor">#ifdef BOUNDARY_CHECK</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="preprocessor"></span>                  assert(       adc_access.getModuleIndex()&lt; _avADC.size());</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="preprocessor">#endif           </span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="preprocessor"></span>                  </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                  <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                    UInt_t cell_i=adc_access.getCellIndexOnModule();</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="preprocessor">#ifdef BOUNDARY_CHECK</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="preprocessor"></span>                    assert(cell_i &lt; _avADC[adc_access.getModuleIndex()].size());</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="preprocessor">#endif              </span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="preprocessor"></span>                    Int_t raw_adc_value=adc_access.getAdcValue();</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                    </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                    _avADC[adc_access.getModuleIndex()][cell_i].add(raw_adc_value);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                  } <span class="keywordflow">while</span> (adc_access.nextValue());</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                } <span class="keywordflow">while</span> (adc_access.nextBlock());</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                <span class="keywordflow">if</span> (_avADCn++&gt;static_cast&lt;UInt_t&gt;(_avADCNMax)) {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                  <span class="keywordflow">for</span> (std::vector&lt; std::vector&lt;Average_t&gt; &gt;::iterator module_iter=_avADC.begin();</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                       module_iter!=_avADC.end();</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                       module_iter++) {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                    <span class="keywordflow">for</span> (std::vector&lt;Average_t&gt;::iterator cell_iter=module_iter-&gt;begin();</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                         cell_iter!=module_iter-&gt;end();</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                         cell_iter++) {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                      cell_iter-&gt;calculate();</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                  }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                  _avADCIsValid=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;              }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;              <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="preprocessor">#ifdef BOUNDARY_CHECK</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="preprocessor"></span>                  assert(       adc_access.getModuleIndex()&lt; _avValues[kNoiseHistory].size());</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="preprocessor">#endif           </span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="preprocessor"></span>                  UInt_t module_index_offset=UINT_MAX;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                  <span class="keywordflow">if</span> (module_index_array.size()&gt;0) {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                    UInt_t module_index=adc_access.getModuleIndex();</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                    <span class="comment">//            UInt_t cell_index=adc_access.getCellIndexOnModule();</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                    <span class="keywordflow">if</span> ((module_index_array.size()) &gt;static_cast&lt;UInt_t&gt;(module_index) + 1) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                      module_index_offset=<span class="keyword">static_cast&lt;</span>UInt_t<span class="keyword">&gt;</span>(module_index_array[module_index]);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                    }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                  }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                  <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                    UInt_t chip_i=adc_access.getCellIndexOnModule()%__nChips;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="preprocessor">#ifdef BOUNDARY_CHECK</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="preprocessor"></span>                    assert(chip_i &lt; _avValues[kNoiseHistory][adc_access.getModuleIndex()].size());</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="preprocessor">#endif              </span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="preprocessor"></span>                    Int_t raw_adc_value=adc_access.getAdcValue();</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                    Float_t noise=FLT_MAX;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                    Float_t pedestal=0;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                    <span class="keywordflow">if</span> (module_index_offset&lt;UINT_MAX) {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                      <a class="code" href="classCALICE_1_1CellParameter.html">CellParameter</a> cell_parameter(cell_parameters-&gt;getElementAt(module_index_offset+adc_access.getCellIndexOnModule()));</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                      noise=cell_parameter.<a class="code" href="classCALICE_1_1CellParameter.html#a58d1f99e4ef0452b94fef27d5de1cc1e">getNoise</a>();</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                      pedestal=cell_parameter.<a class="code" href="classCALICE_1_1CellParameter.html#a3223608e5f680b674e7181b5c4495935">getPedestal</a>();</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                      _avValues[kNoiseHistory][adc_access.getModuleIndex()][chip_i].add(noise);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                      _avValues[kPedestalHistory][adc_access.getModuleIndex()][chip_i].add(pedestal);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                    }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                    <span class="keywordflow">if</span> (raw_adc_value-pedestal&lt;_signalCut*noise) {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                      _avValues[kADCHistory][adc_access.getModuleIndex()][chip_i].add(raw_adc_value-_avADC[adc_access.getModuleIndex()][adc_access.getCellIndexOnModule()].mean());</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                    }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                      _avValues[kHitHistory][adc_access.getModuleIndex()][chip_i].add(1);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                    }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                  } <span class="keywordflow">while</span> (adc_access.nextValue());</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                } <span class="keywordflow">while</span> (adc_access.nextBlock());</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;              }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="keywordflow">if</span> (event_nr%static_cast&lt;UInt_t&gt;(_eventPar[0])==0) {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;          <span class="keywordflow">if</span> (_avADCIsValid) {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="keywordflow">for</span> (UInt_t history_i=0; history_i&lt;kNHistoryGraphs; history_i++) {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="preprocessor">#ifdef BOUNDARY_CHECK</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="preprocessor"></span>              assert( history_i&lt;_avValueHistoryKey.size() );</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="preprocessor"></span>              <a class="code" href="classhistmgr_1_1GraphCollection__t.html">histmgr::GraphCollection_t</a> &amp;graph_col=histogramList-&gt;<a class="code" href="classhistmgr_1_1HistMgr.html#a6c5ea89b82f7d9df93423976abdf6470">getGraphCollection</a>(_graphGroupKey,_avValueHistoryKey[history_i]);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;              UInt_t history_val_i = graph_col.<a class="code" href="classhistmgr_1_1GraphCollection__t.html#ae9c83cf79211ef808f75343c7c3c3c3d">appendXValue</a>(stamp);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;              <span class="keywordflow">for</span> (UInt_t module_i=0; module_i&lt;_mapping.getNModules(); module_i++) {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <span class="keywordflow">for</span> (UInt_t chip_i=0; chip_i&lt;_mapping.getNCellsPerModule(module_i)/__nSamplesPerChip; chip_i++) {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                  <span class="keywordflow">if</span> (_avValues[history_i][module_i][chip_i].weight()&gt;=0) {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                    _avValues[history_i][module_i][chip_i].calculate();</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                    graph_col.setYValue(module_i,chip_i,kGraphMean,history_val_i, _avValues[history_i][module_i][chip_i].mean());</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                    graph_col.setYValue(module_i,chip_i,kGraphRMS,history_val_i, _avValues[history_i][module_i][chip_i].sigma());</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                    graph_col.setYValue(module_i,chip_i,kGraphMin,history_val_i, _avValues[history_i][module_i][chip_i].min());</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                    graph_col.setYValue(module_i,chip_i,kGraphMax,history_val_i, _avValues[history_i][module_i][chip_i].max());</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                    graph_col.setYValue(module_i,chip_i,kGraphWeight,history_val_i, _avValues[history_i][module_i][chip_i].weight());</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">//                  _history[history_i][kGraphMean][module_i][chip_i].push_back(_avValues[history_i][module_i][chip_i].mean());</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">//                  _history[history_i][kGraphRMS][module_i][chip_i].push_back(_avValues[history_i][module_i][chip_i].sigma());</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">//                  _history[history_i][kGraphMin][module_i][chip_i].push_back(_avValues[history_i][module_i][chip_i].min());</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">//                  _history[history_i][kGraphMax][module_i][chip_i].push_back(_avValues[history_i][module_i][chip_i].max());</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">//                  _history[history_i][kGraphWeight][module_i][chip_i].push_back(_avValues[history_i][module_i][chip_i].weight());</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                  }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (history_val_i&gt;0) {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                    graph_col.setYValue(module_i,chip_i,kGraphMean,history_val_i,graph_col.getYValue(module_i,chip_i,kGraphMean,history_val_i-1));</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                    graph_col.setYValue(module_i,chip_i,kGraphRMS,history_val_i,graph_col.getYValue(module_i,chip_i,kGraphRMS,history_val_i-1));</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                    graph_col.setYValue(module_i,chip_i,kGraphMin,history_val_i,graph_col.getYValue(module_i,chip_i,kGraphMin,history_val_i-1));</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                    graph_col.setYValue(module_i,chip_i,kGraphMax,history_val_i,graph_col.getYValue(module_i,chip_i,kGraphMax,history_val_i-1));</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                    graph_col.setYValue(module_i,chip_i,kGraphWeight,history_val_i,graph_col.getYValue(module_i,chip_i,kGraphWeight,history_val_i-1));</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">//                  _history[history_i][kGraphMean][module_i][chip_i].push_back(_history[history_i][kGraphMean][module_i][chip_i].back());</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">//                  _history[history_i][kGraphRMS][module_i][chip_i].push_back(_history[history_i][kGraphRMS][module_i][chip_i].back());</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">//                  _history[history_i][kGraphMin][module_i][chip_i].push_back(_history[history_i][kGraphMin][module_i][chip_i].back());</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">//                  _history[history_i][kGraphMax][module_i][chip_i].push_back(_history[history_i][kGraphMax][module_i][chip_i].back());</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">//                  _history[history_i][kGraphWeight][module_i][chip_i].push_back(_history[history_i][kGraphWeight][module_i][chip_i].back());</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                  }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                    graph_col.setYValue(module_i,chip_i,kGraphMean,history_val_i,0.);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                    graph_col.setYValue(module_i,chip_i,kGraphRMS,history_val_i,0.);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                    graph_col.setYValue(module_i,chip_i,kGraphMin,history_val_i,0.);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                    graph_col.setYValue(module_i,chip_i,kGraphMax,history_val_i,0.);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                    graph_col.setYValue(module_i,chip_i,kGraphWeight,history_val_i,0.);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">//                  _history[history_i][kGraphMean][module_i][chip_i].push_back(0.);</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">//                  _history[history_i][kGraphRMS][module_i][chip_i].push_back(0.);</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">//                  _history[history_i][kGraphMin][module_i][chip_i].push_back(0.);</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">//                  _history[history_i][kGraphMax][module_i][chip_i].push_back(0.);</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">//                  _history[history_i][kGraphWeight][module_i][chip_i].push_back(0.);</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                  }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                  _avValues[history_i][module_i][chip_i]=Average_t();</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;              }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            <span class="comment">//      _historyStamps[kHistoryStamp].push_back(stamp);</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;          }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="keywordflow">catch</span> (  DataNotAvailableException &amp;err) {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    _confChanged=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keywordtype">void</span> AverageHistoryGraphs::end() </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">//    std::cout &lt;&lt; &quot;---- AverageHistoryGraphs: report&gt;&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="comment">//    std::cout &lt;&lt; &quot;\t&quot; &lt;&lt; _historyStamps[kHistoryStamp].size() &lt;&lt; &quot; : number of events per graph.&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">//    writeGraphs();</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">//   void AverageHistoryGraphs::writeGraphs() {</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">// #ifdef HAVE_ROOT</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">//     Bool_t have_events=false;</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">//     for (UInt_t hist_i=0; hist_i&lt;kNHistoryStamps; hist_i++) {</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">//       if (_historyStamps[hist_i].size()&gt;0 ) {</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">//      have_events=true;</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">//      break;</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">//       }</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">//     }</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">//     if (!have_events) return;</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">//     TFile a_file(_outputFileName.c_str(),&quot;UPDATE&quot;);</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">//     TDirectory *folder_dir=&amp;a_file;</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">//     if (!_folderName.empty()) {</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">//       TObject *obj=a_file.Get(_folderName.c_str());</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">//       if (obj &amp;&amp; obj-&gt;InheritsFrom(TDirectory::Class())) {</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">//      TDirectory *a_dir=(TDirectory *) obj;</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">//      a_dir-&gt;cd();</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">//      folder_dir=a_dir;</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">//       }</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">//       else {</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">//      a_file.mkdir(_folderName.c_str());</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">//      TObject *obj=a_file.Get(_folderName.c_str());</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">//      if (obj &amp;&amp; obj-&gt;InheritsFrom(TDirectory::Class())) {</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">//        TDirectory *a_dir=(TDirectory *) obj;</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">//        a_dir-&gt;cd();</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">//        folder_dir=a_dir;</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">//       }</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">//     }</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">//     UInt_t n_written_graphs=0;</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">//     {</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">//       if (_historyStamps[kHistoryConfStamp].size()&gt;0) {</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">//      vector&lt;unsigned int&gt; yarr;</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">//      for (vector&lt;Double_t&gt;::const_iterator point_iter=_historyStamps[kHistoryConfStamp].begin();</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">//           point_iter!=_historyStamps[kHistoryConfStamp].end();</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">//           point_iter++) {</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">//        yarr.push_back(0);</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">//      TGraph *a_graph=makeGraph(&quot;configChanges&quot;,_historyStamps[kHistoryConfStamp],yarr);</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">//      if (a_graph) {</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">//        a_graph-&gt;Write();</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">//        n_written_graphs++;</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">//       }</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">//       if (_historyStamps[kHistoryStateStamp].size()&gt;0) {</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">//      TGraph *a_graph=makeGraph(&quot;stateChanges&quot;,_historyStamps[kHistoryStateStamp],_historyStamps[kHistoryStateValue]);</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">//      if (a_graph) {</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">//        a_graph-&gt;Write();</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">//        n_written_graphs++;</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">//       }</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">//     }</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">//     if (_historyStamps[kHistoryStamp].size()&gt;0) {</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">//       for (UInt_t history_i=0; history_i&lt;kNHistoryGraphs; history_i++) {</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">//      if (folder_dir) {</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">//        folder_dir-&gt;cd();</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">//        TObject *obj=folder_dir-&gt;Get(__historyGraphNames[history_i]);</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">//        if (obj &amp;&amp; obj-&gt;InheritsFrom(TDirectory::Class())) {</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">//          TDirectory *a_dir=(TDirectory *) obj;</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">//          a_dir-&gt;cd();</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">//        }</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">//        else {</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">//          folder_dir-&gt;mkdir(__historyGraphNames[history_i]);</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">//          TObject *obj=folder_dir-&gt;Get(__historyGraphNames[history_i]);</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">//          if (obj &amp;&amp; obj-&gt;InheritsFrom(TDirectory::Class())) {</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">//            TDirectory *a_dir=(TDirectory *) obj;</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">//            a_dir-&gt;cd();</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">//          }</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">//        }</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">//      for (UInt_t graph_i=0; graph_i&lt;kNGraphs; graph_i++) {</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">//        if (graph_i==kGraphRMS) continue;</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">//        UInt_t module_i=0;</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">//        for (std::vector&lt; std::vector&lt; std::vector&lt; Float_t&gt; &gt; &gt;::const_iterator arr_iter=_history[history_i][graph_i].begin();</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">//             arr_iter!=_history[history_i][graph_i].end();</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">//             arr_iter++,module_i++) {</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">//          UInt_t chip_i=0;</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">//          for (std::vector&lt; std::vector&lt; Float_t&gt; &gt;::const_iterator iter=arr_iter-&gt;begin();</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">//               iter!=arr_iter-&gt;end();</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">//               iter++,chip_i++) {</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">// #ifdef BOUNDARY_CHECK</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">//            assert(iter-&gt;size()==_historyStamps[kHistoryStamp].size() );</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">// #endif</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">//            TGraph *a_graph=0;</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">//            std::stringstream name;</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">//            name &lt;&lt; __historyGraphNames[history_i] &lt;&lt; &quot;_&quot; &lt;&lt; __graphNames[graph_i] &lt;&lt; module_i &lt;&lt; &quot;_&quot; &lt;&lt; chip_i;</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">//            if (graph_i==kGraphMean) {</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">//              a_graph=makeGraph(name.str().c_str(),_historyStamps[kHistoryStamp],(*iter),</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">//                                _history[history_i][kGraphRMS][module_i][chip_i]);</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">//            }</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">//            else {</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">//              a_graph=makeGraph(name.str().c_str(),_historyStamps[kHistoryStamp],(*iter));</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">//            }</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">//            if (a_graph) {</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">//              a_graph-&gt;Write();</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">//              n_written_graphs++;</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">//              delete a_graph;</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">//            }</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">//          }</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">//        }</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">//       }</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">//     }</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">//     {</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">//       for (UInt_t history_i=0; history_i&lt;kNHistoryGraphs; history_i++) {</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">//      _historyStamps[history_i].clear();</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">//       }</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">//       for (UInt_t history_i=0; history_i&lt;kNHistoryGraphs; history_i++) {</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">//      for (UInt_t graph_i=0; graph_i&lt;kNGraphs; graph_i++) {</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">//        for (std::vector&lt; std::vector&lt; std::vector&lt; Float_t&gt; &gt; &gt;::iterator arr_iter=_history[history_i][graph_i].begin();</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">//             arr_iter!=_history[history_i][graph_i].end();</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">//             arr_iter++) {</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">//          for (std::vector&lt; std::vector&lt; Float_t&gt; &gt;::iterator iter=arr_iter-&gt;begin();</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">//               iter!=arr_iter-&gt;end();</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">//               iter++) {</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">//            iter-&gt;clear();</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">//          }</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">//        }</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">//       }</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">//     }</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">//     std::cout &lt;&lt; &quot;\t Write: &quot; &lt;&lt; n_written_graphs &lt;&lt; &quot; graphs to &quot; &lt;&lt; _outputFileName.c_str() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">// #endif      </span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">//   }</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;}</div>
<div class="ttc" id="classCALICE_1_1CellParameter_html_a58d1f99e4ef0452b94fef27d5de1cc1e"><div class="ttname"><a href="classCALICE_1_1CellParameter.html#a58d1f99e4ef0452b94fef27d5de1cc1e">CALICE::CellParameter::getNoise</a></div><div class="ttdeci">Float_t getNoise() const </div><div class="ttdoc">Get the noise. </div><div class="ttdef"><b>Definition:</b> <a href="CellParameter_8hh_source.html#l00153">CellParameter.hh:153</a></div></div>
<div class="ttc" id="classhistmgr_1_1HistMgr_html_a6c5ea89b82f7d9df93423976abdf6470"><div class="ttname"><a href="classhistmgr_1_1HistMgr.html#a6c5ea89b82f7d9df93423976abdf6470">histmgr::HistMgr::getGraphCollection</a></div><div class="ttdeci">GraphCollection_t &amp; getGraphCollection(const Key_t &amp;group_key, const Key_t &amp;graph_key)</div><div class="ttdoc">Get a graph collection. </div><div class="ttdef"><b>Definition:</b> <a href="HistMgr_8hh_source.html#l00856">HistMgr.hh:856</a></div></div>
<div class="ttc" id="classhistmgr_1_1HistMgr_html_abe2360d4b53c1ac18f193be4e9428e3a"><div class="ttname"><a href="classhistmgr_1_1HistMgr.html#abe2360d4b53c1ac18f193be4e9428e3a">histmgr::HistMgr::lockGroup</a></div><div class="ttdeci">void lockGroup(const Key_t &amp;group_key)</div><div class="ttdoc">Lock a histogram group. </div><div class="ttdef"><b>Definition:</b> <a href="HistMgr_8hh_source.html#l00981">HistMgr.hh:981</a></div></div>
<div class="ttc" id="classhistmgr_1_1GraphCollection__t_html"><div class="ttname"><a href="classhistmgr_1_1GraphCollection__t.html">histmgr::GraphCollection_t</a></div><div class="ttdoc">Light wrapper around a LCCollection to facilitate the handling of collections of graphs. </div><div class="ttdef"><b>Definition:</b> <a href="GraphCollection__t_8hh_source.html#l00027">GraphCollection_t.hh:27</a></div></div>
<div class="ttc" id="classCALICE_1_1VRawADCValueProcessor_html_a9af055c07a4e40284ba7851ee901d7af"><div class="ttname"><a href="classCALICE_1_1VRawADCValueProcessor.html#a9af055c07a4e40284ba7851ee901d7af">CALICE::VRawADCValueProcessor::_adcColName</a></div><div class="ttdeci">std::string _adcColName</div><div class="ttdoc">Name of the input collection (INPUT). </div><div class="ttdef"><b>Definition:</b> <a href="VRawADCValueProcessor_8hh_source.html#l00028">VRawADCValueProcessor.hh:28</a></div></div>
<div class="ttc" id="classhistmgr_1_1HistogramCollection__t_html_aba86c24635ec931b9eef136bddaa897c"><div class="ttname"><a href="classhistmgr_1_1HistogramCollection__t.html#aba86c24635ec931b9eef136bddaa897c">histmgr::HistogramCollection_t::nMinor</a></div><div class="ttdeci">UInt_t nMinor(UInt_t major_index) const </div><div class="ttdoc">get the number of histograms in the one dimensional collection. </div><div class="ttdef"><b>Definition:</b> <a href="HistogramCollection__t_8hh_source.html#l00227">HistogramCollection_t.hh:227</a></div></div>
<div class="ttc" id="classhistmgr_1_1HistMgr_html_a04aa842cbcd765c10fa47afd05a31b6f"><div class="ttname"><a href="classhistmgr_1_1HistMgr.html#a04aa842cbcd765c10fa47afd05a31b6f">histmgr::HistMgr::createHistogramGroup</a></div><div class="ttdeci">void createHistogramGroup(const Key_t &amp;group_key)</div><div class="ttdoc">Create an empty histogram group to which histograms can be assigned. </div><div class="ttdef"><b>Definition:</b> <a href="HistMgr_8hh_source.html#l00313">HistMgr.hh:313</a></div></div>
<div class="ttc" id="classCALICE_1_1AverageHistoryGraphs_html_a3734a824ecbe14585605e459c40b7f67"><div class="ttname"><a href="classCALICE_1_1AverageHistoryGraphs.html#a3734a824ecbe14585605e459c40b7f67">CALICE::AverageHistoryGraphs::init</a></div><div class="ttdeci">void init()</div><div class="ttdoc">Called at the begin of the job before anything is read. </div><div class="ttdef"><b>Definition:</b> <a href="AverageHistoryGraphs_8cc_source.html#l00121">AverageHistoryGraphs.cc:121</a></div></div>
<div class="ttc" id="classhistmgr_1_1HistMgr_html_ac3793935c147dc10f3ef167632794802"><div class="ttname"><a href="classhistmgr_1_1HistMgr.html#ac3793935c147dc10f3ef167632794802">histmgr::HistMgr::writeHistograms</a></div><div class="ttdeci">void writeHistograms(bool snapshot=false)</div><div class="ttdoc">write all histograms groups to the assigned files. </div><div class="ttdef"><b>Definition:</b> <a href="HistMgr_8cc_source.html#l00291">HistMgr.cc:291</a></div></div>
<div class="ttc" id="classhistmgr_1_1HistMgr_1_1Group__t_html_aba01ed4567e276b2a71494f6755c520f"><div class="ttname"><a href="classhistmgr_1_1HistMgr_1_1Group__t.html#aba01ed4567e276b2a71494f6755c520f">histmgr::HistMgr::Group_t::histogramCollection</a></div><div class="ttdeci">HistogramCollection_t &amp; histogramCollection(const Key_t &amp;a_key)</div><div class="ttdoc">Get the histogram collection addressed by the key. </div><div class="ttdef"><b>Definition:</b> <a href="HistMgr_8hh_source.html#l00133">HistMgr.hh:133</a></div></div>
<div class="ttc" id="classCALICE_1_1AverageHistoryGraphs_html_a1b70e2c0f46158aac6fe28edb2ca23cf"><div class="ttname"><a href="classCALICE_1_1AverageHistoryGraphs.html#a1b70e2c0f46158aac6fe28edb2ca23cf">CALICE::AverageHistoryGraphs::processEvent</a></div><div class="ttdeci">void processEvent(LCEvent *evtP)</div><div class="ttdoc">Called for every event - the working horse. </div><div class="ttdef"><b>Definition:</b> <a href="AverageHistoryGraphs_8cc_source.html#l00251">AverageHistoryGraphs.cc:251</a></div></div>
<div class="ttc" id="classCALICE_1_1CellParameter_html"><div class="ttname"><a href="classCALICE_1_1CellParameter.html">CALICE::CellParameter</a></div><div class="ttdoc">Information about a pad: Pedestal, noise, etc. </div><div class="ttdef"><b>Definition:</b> <a href="CellParameter_8hh_source.html#l00070">CellParameter.hh:70</a></div></div>
<div class="ttc" id="classhistmgr_1_1HistMgr_html_a89c74c851c7f8cf2b2eef7d358054bd8"><div class="ttname"><a href="classhistmgr_1_1HistMgr.html#a89c74c851c7f8cf2b2eef7d358054bd8">histmgr::HistMgr::createGraphCollection</a></div><div class="ttdeci">lcio::LCCollection * createGraphCollection(const Key_t &amp;group_key, const Key_t &amp;collection_key, unsigned int n_graphs, const EVENT::StringVec &amp;type_names, unsigned int n_expected_values, const EVENT::StringVec &amp;opt_major_names, bool may_overwrite=false) noexcept(false)</div><div class="ttdoc">Create a collection of graphs. </div><div class="ttdef"><b>Definition:</b> <a href="HistMgr_8cc_source.html#l00222">HistMgr.cc:222</a></div></div>
<div class="ttc" id="classhistmgr_1_1Key__t_html"><div class="ttname"><a href="classhistmgr_1_1Key__t.html">histmgr::Key_t</a></div><div class="ttdoc">A string key which will get a numeric identifier. </div><div class="ttdef"><b>Definition:</b> <a href="Key__t_8hh_source.html#l00016">Key_t.hh:16</a></div></div>
<div class="ttc" id="classhistmgr_1_1HistogramCollection__t_html_a02818178f9b34adc8fc34077f1111ae0"><div class="ttname"><a href="classhistmgr_1_1HistogramCollection__t.html#a02818178f9b34adc8fc34077f1111ae0">histmgr::HistogramCollection_t::nMajor</a></div><div class="ttdeci">UInt_t nMajor() const </div><div class="ttdoc">get the number of histograms in the one dimensional collection. </div><div class="ttdef"><b>Definition:</b> <a href="HistogramCollection__t_8hh_source.html#l00219">HistogramCollection_t.hh:219</a></div></div>
<div class="ttc" id="classCALICE_1_1CellParameter_html_a3223608e5f680b674e7181b5c4495935"><div class="ttname"><a href="classCALICE_1_1CellParameter.html#a3223608e5f680b674e7181b5c4495935">CALICE::CellParameter::getPedestal</a></div><div class="ttdeci">Float_t getPedestal() const </div><div class="ttdoc">Get the pedestal. </div><div class="ttdef"><b>Definition:</b> <a href="CellParameter_8hh_source.html#l00131">CellParameter.hh:131</a></div></div>
<div class="ttc" id="classhistmgr_1_1GraphCollection__t_html_a2d86a21418a91537e8cb831673b4e88b"><div class="ttname"><a href="classhistmgr_1_1GraphCollection__t.html#a2d86a21418a91537e8cb831673b4e88b">histmgr::GraphCollection_t::setYValue</a></div><div class="ttdeci">void setYValue(unsigned int major_index, unsigned int minor_index, unsigned int type_index, unsigned int value_index, float a_value)</div><div class="ttdoc">Set the y-value of the adddressed graph. </div><div class="ttdef"><b>Definition:</b> <a href="GraphCollection__t_8hh_source.html#l00341">GraphCollection_t.hh:341</a></div></div>
<div class="ttc" id="classhistmgr_1_1HistMgr_1_1Group__t_html_a6dcb61b2793e12470bfd28e4dfeaafef"><div class="ttname"><a href="classhistmgr_1_1HistMgr_1_1Group__t.html#a6dcb61b2793e12470bfd28e4dfeaafef">histmgr::HistMgr::Group_t::histogramCollectionExists</a></div><div class="ttdeci">bool histogramCollectionExists(const Key_t &amp;a_key) const </div><div class="ttdoc">Verify whether a histogram collection exists. </div><div class="ttdef"><b>Definition:</b> <a href="HistMgr_8hh_source.html#l00129">HistMgr.hh:129</a></div></div>
<div class="ttc" id="classCALICE_1_1AdcValueAccess_html"><div class="ttname"><a href="classCALICE_1_1AdcValueAccess.html">CALICE::AdcValueAccess</a></div><div class="ttdoc">Hide hit reconstruction: ADC value to position mapping, calibration. </div><div class="ttdef"><b>Definition:</b> <a href="AdcValueAccess_8hh_source.html#l00029">AdcValueAccess.hh:29</a></div></div>
<div class="ttc" id="classhistmgr_1_1HistMgr_html"><div class="ttname"><a href="classhistmgr_1_1HistMgr.html">histmgr::HistMgr</a></div><div class="ttdoc">Manages lists of histograms which can be written to prior assigned files. </div><div class="ttdef"><b>Definition:</b> <a href="HistMgr_8hh_source.html#l00043">HistMgr.hh:43</a></div></div>
<div class="ttc" id="classhistmgr_1_1GraphCollection__t_html_ae9c83cf79211ef808f75343c7c3c3c3d"><div class="ttname"><a href="classhistmgr_1_1GraphCollection__t.html#ae9c83cf79211ef808f75343c7c3c3c3d">histmgr::GraphCollection_t::appendXValue</a></div><div class="ttdeci">unsigned int appendXValue(double x_value)</div><div class="ttdoc">Set the common x value of all the graphs of the graph collection. </div><div class="ttdef"><b>Definition:</b> <a href="GraphCollection__t_8hh_source.html#l00204">GraphCollection_t.hh:204</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
